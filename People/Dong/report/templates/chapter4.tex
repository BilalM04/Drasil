\chapter{Connect Model to Libraries}
In chapter 2, we stored the information of a higher-order linear ODE in the \verb|DifferentialModel|. This record preserve the relationship of the ODE, and we can transform the ODE to other forms. In chapter 3, we discuss how to solve a system of first-order equations numerically in four different external libraries. What we have not discussed is that how to how to close the gap between the \verb|DifferentialModel| and external libraries. All external libraries do not understands what is a \verb|DifferentialModel|, so this is the problem we want to solve in this chapter. What we know is that most way for solving ODEs are intended for first-order equations, and we can covert most higher-order ODEs to a system of first-order equations~\citep{converthigherode}. 
Theoretically, we can transform a higher-order linear ODE to a system of first-order equations. Then, giving the equivalent system of first-order equations to external libraries, we can get the numerical solution for the higher-order linear ODE.

In this chapter, we will first discuss how to convert a higher-order linear ODE to a system of first order equations in theory. Then, we will talk about how to connect explicit equation with external libraries. Last, we will discuss how to generate explicit equation base on \verb|DifferentialModel|.

\section{Higher Order to First Order}
We can write a linear system of first-order ODE in shape of the equation~\ref{eq_foode}. The \textbf{A} is a coefficient matrix, and c is a constant vector. The \textbf{X} is the unknown vector contains functions of the independent variable, often time. The \textbf{X}' is a vector that consist of first derivative of functions in \textbf{X}.
\begin{equation} \label{eq_foode}
    \boldsymbol{X}' = \boldsymbol{AX} + \boldsymbol{c}
\end{equation}

% Most way for solving ODEs are intended for first-order equations, and we can covert most higher-order ODEs to a system of first-order equations~\citep{converthigherode}. If we have a higher-order linear ODE, we can covert it to a system of first order ODE. So, how to convert a higher-order ODE in shape of \textbf{Ax} = \textbf{b} (~\ref{eq_matrixform}) to a system of first order equations in shape of \textbf{X}' = \textbf{AX} + \textbf{c} (~\ref{eq_foode})?

Given a higher-order ODE, we can write it in form of the equation~\ref{eq_isohighode}. We put the highest derivative $x^n$ on the left hand side, and the rest of terms on right hand side. On the right hand side, $f (t, x, x', x'', \dots, x^{n-1})$ means a function depends on variables t, x, x', \dots, and $x^{n-1}$. The t is independent variable and it is time. The x, x', \dots, and $x^{n-1}$ means the dependent variable x, first derivative of x, and until n-1 derivative.
\begin{equation} \label{eq_isohighode}
  x^n = f (t, x, x', x'', \dots, x^{n-1})
\end{equation}

Later, we introduce new variables, $y_{1}$, $y_{2}$, $\dots$, and $y_{n}$, and the new relationship show at below.
\begin{flalign} \label{eq_newvars}
  & y_{1} = x \\ \nonumber
  & y_{2} = x' \\ \nonumber
  & \dots \\ \nonumber
  & y_{n} = x^{n-1} 
\end{flalign}

Now, we can start differentiate $y_{1}$, $y_{2}$, $\dots$, and $y_{n}$ in equation~\ref{eq_newvars}. Then, we get new relationship between each variable.
\begin{flalign} \label{eq_diffvervars}
  & y_{1}' = x' = y_{2} \\ \nonumber
  & y_{2}' = x'' = y_{3} \\ \nonumber
  & \dots \\ \nonumber
  & y_{n}' = x^{n} = f (t, y_{1}, y_{2}, \dots, y_{n})
\end{flalign}

The $f (t, y_{1}, y_{2}, \dots, y_{n})$ is a linear function, and we can rewrite them as the following
\begin{equation}\label{eq_linear}
h(t) + g_{1}(t) \cdot y_{1} + g_{2}(t) \cdot y_{2} + ... + g_{n}(t) \cdot y_{n}
\end{equation}

Based on the equation~\ref{eq_diffvervars}, we can simplify equations by removing derivatives of x and replace $f (t, y_{1}, y_{2}, \dots, y_{n})$ with equation~\ref{eq_linear}. Then, we can get:
\begin{flalign} \label{eq_diffvervarslinear}
    & y_{1}' = y_{2} \\ \nonumber
    & y_{2}' = y_{3} \\ \nonumber
    & \dots \\ \nonumber
    & y_{n}'= h(t) + g_{1}(t) \cdot y_{1} + g_{2}(t) \cdot y_{2} + ... + g_{n}(t) \cdot y_{n}
\end{flalign}

Last, we can rewrite the equation~\ref{eq_diffvervarslinear} in form of \textbf{X}' = \textbf{AX} + \textbf{c}
\begin{equation}
	\begin{bmatrix}
		y_{1}' \\
        y_{2}' \\
        \dots  \\
        y_{n}'
	\end{bmatrix}
    = 
    \begin{bmatrix}
		0, & 1, & 0, & \dots, & 0 \\
        0, & 0, & 1, & \dots, & 0 \\
        \dots \\
        g_{1}(t), & g_{2}(t), & g_{3}(t), & \dots, & g_{n}(t)
	\end{bmatrix}
    \cdot
    \begin{bmatrix}
		y_{1} \\
        y_{2} \\
        \dots  \\
        y_{n}
	\end{bmatrix}
    + 
    \begin{bmatrix}
		0 \\
        0 \\
        \dots  \\
        h(t)
	\end{bmatrix}
\end{equation}

\section{Connect Explicit Equations to Libraries}
double pendulum example
limitation: duplication

\section{Generate Explicit Equations}
generate equations
reduce duplication

